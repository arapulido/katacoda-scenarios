It seems like the issue is when we access the DB getting discounts, the call seems rather inefficient, can you find more data ?
# call is ...